# 安卓信号测试软件优化功能规格说明

## 1. 项目概述
本文档描述了安卓信号测试软件的后续优化功能需求和技术实现方案，按照1→3→5→2→4→6的顺序实施。

## 2. 优化功能需求

### 2.1 功能1：增加5G网络的详细信息采集

#### 2.1.1 功能描述
- 采集5G网络特有的详细信息，包括NR小区ID、频点、频段、SSB信号强度等参数
- 在主界面和拍照信息叠加层中显示5G网络信息
- 支持5G网络类型的自动识别和切换

#### 2.1.2 技术要求
- 支持Android 10及以上版本
- 正确处理5G SA（独立组网）和NSA（非独立组网）模式
- 采集参数符合3GPP标准

#### 2.1.3 验收标准
- 能正确识别5G网络类型
- 能采集并显示5G特有参数
- 在5G网络环境下工作正常

### 2.2 功能3：实现数据导出为CSV或Excel格式

#### 2.2.1 功能描述
- 支持将测试数据导出为CSV或Excel格式
- 支持选择导出范围（全部/指定时间范围）
- 支持导出文件存储路径选择
- 导出完成后提示用户

#### 2.2.2 技术要求
- 导出文件格式符合标准CSV/Excel规范
- 支持大数量数据导出（1000条以上）
- 导出过程中显示进度条

#### 2.2.3 验收标准
- 能成功导出CSV格式文件
- 能成功导出Excel格式文件
- 导出文件内容完整准确
- 导出过程稳定无崩溃

### 2.3 功能5：增加信号强度变化图表分析

#### 2.3.1 功能描述
- 显示信号强度随时间变化的趋势图
- 支持不同参数的图表切换（RSSI、SINR、RSRP等）
- 支持图表缩放和时间范围选择
- 支持图表导出为图片

#### 2.3.2 技术要求
- 使用高性能图表库
- 支持实时数据更新
- 图表交互流畅

#### 2.3.3 验收标准
- 图表显示正确的信号强度变化趋势
- 支持多种参数的切换显示
- 图表交互响应流畅
- 能成功导出图表为图片

### 2.4 功能2：添加地图显示功能，标记测试地点

#### 2.4.1 功能描述
- 在地图上显示测试地点标记
- 点击标记查看详细信号信息
- 支持地图缩放和导航
- 支持批量标记显示

#### 2.4.2 技术要求
- 集成地图SDK（Google Maps或百度地图）
- 处理位置权限
- 优化地图加载性能

#### 2.4.3 验收标准
- 地图能正确显示测试地点
- 标记信息准确完整
- 地图操作流畅
- 支持不同缩放级别

### 2.5 功能4：优化相机预览性能和拍照质量

#### 2.5.1 功能描述
- 提高相机预览帧率
- 支持4K拍照
- 优化图像处理速度，减少拍照延迟
- 支持HDR模式

#### 2.5.2 技术要求
- 合理配置CameraX参数
- 优化图像处理流程
- 支持不同设备的相机特性

#### 2.5.3 验收标准
- 相机预览流畅，无卡顿
- 拍照质量清晰，支持高分辨率
- 拍照延迟明显减少
- 支持HDR模式

### 2.6 功能6：支持批量测试和自动报告生成

#### 2.6.1 功能描述
- 支持设置测试间隔和持续时间
- 自动执行测试并记录数据
- 生成包含图表和分析的PDF报告
- 支持报告模板定制

#### 2.6.2 技术要求
- 使用WorkManager处理后台测试任务
- 支持网络状态变化检测
- 优化电池消耗

#### 2.6.3 验收标准
- 能按照设定的间隔自动执行测试
- 测试数据完整记录
- 能生成包含图表的PDF报告
- 报告内容准确详细

## 3. 技术实现方案

### 3.1 功能1：增加5G网络的详细信息采集

#### 3.1.1 核心代码修改
- 扩展`SignalCollector.java`类，增加`getCellInfo5G()`方法
- 修改`getNetworkType()`方法，支持5G网络识别
- 更新`SignalData.java`模型，增加5G特有字段

#### 3.1.2 界面修改
- 更新主界面布局，增加5G参数显示
- 更新相机界面叠加层，显示5G信息

### 3.2 功能3：实现数据导出为CSV或Excel格式

#### 3.2.1 核心代码修改
- 创建`ExportUtils.java`工具类，实现数据导出功能
- 修改`HistoryActivity.java`，增加导出按钮和相关逻辑
- 增加导出设置对话框

#### 3.2.2 依赖库
- 添加Apache POI库用于Excel文件处理

### 3.3 功能5：增加信号强度变化图表分析

#### 3.3.1 核心代码修改
- 创建`ChartActivity.java`，实现图表显示功能
- 添加`ChartUtils.java`工具类，处理图表数据
- 修改数据库结构，增加信号历史数据表

#### 3.3.2 依赖库
- 添加MPAndroidChart库用于图表显示

### 3.4 功能2：添加地图显示功能，标记测试地点

#### 3.4.1 核心代码修改
- 创建`MapActivity.java`，实现地图显示功能
- 添加`MapUtils.java`工具类，处理地图操作
- 修改`SignalData.java`，增加地图相关字段

#### 3.4.2 依赖库
- 添加Google Maps SDK或百度地图SDK

### 3.5 功能4：优化相机预览性能和拍照质量

#### 3.5.1 核心代码修改
- 修改`CameraActivity.java`，优化CameraX配置
- 调整`CameraUtils.java`中的图像处理逻辑
- 增加相机参数设置功能

### 3.6 功能6：支持批量测试和自动报告生成

#### 3.6.1 核心代码修改
- 创建`BatchTestActivity.java`，实现批量测试设置
- 添加`ReportGenerator.java`工具类，生成PDF报告
- 使用WorkManager实现后台测试任务

#### 3.6.2 依赖库
- 添加iText库用于PDF生成

## 4. 实施计划

### 4.1 阶段1：功能1（5G网络信息采集）
- 扩展数据模型和信号采集服务
- 更新界面显示逻辑
- 测试5G网络环境下的功能

### 4.2 阶段2：功能3（数据导出）
- 实现导出工具类
- 添加导出界面和逻辑
- 测试不同格式的导出功能

### 4.3 阶段3：功能5（信号强度图表）
- 集成图表库
- 实现图表显示界面
- 测试图表数据准确性

### 4.4 阶段4：功能2（地图显示）
- 集成地图SDK
- 实现地图显示和标记功能
- 测试地图操作和性能

### 4.5 阶段5：功能4（相机优化）
- 优化CameraX配置
- 调整图像处理逻辑
- 测试相机性能和拍照质量

### 4.6 阶段6：功能6（批量测试和报告生成）
- 实现批量测试功能
- 开发报告生成工具
- 测试自动测试和报告生成流程

## 5. 验收标准

### 5.1 功能验收
- 每个功能按照规格说明实现完整
- 功能之间无冲突
- 所有功能在目标设备上正常工作

### 5.2 性能验收
- 应用运行流畅，无明显卡顿
- 电池消耗合理
- 内存占用在正常范围内

### 5.3 兼容性验收
- 支持Android 6.0及以上版本
- 在不同品牌设备上正常运行
- 支持不同网络环境

## 6. 风险评估

### 6.1 潜在风险
- 5G网络信息采集在不同设备上的兼容性问题
- 地图SDK集成的复杂性和API密钥管理
- 批量测试过程中的电池消耗问题
- 大数量数据导出的性能问题

### 6.2 应对措施
- 针对不同设备进行充分测试，提供兼容性处理
- 严格按照地图SDK文档集成，安全管理API密钥
- 优化批量测试的电池使用策略
- 实现数据分批处理，避免内存溢出

## 7. 结论
本优化方案通过增加5G网络支持、数据导出、图表分析、地图显示、相机优化和批量测试等功能，将使安卓信号测试软件从基础工具升级为专业的网络测试解决方案，满足更多专业用户的需求。